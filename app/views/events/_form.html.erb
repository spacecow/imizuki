<%= semantic_form_for @event, :html => {:multipart => true} do |f| %>
  <%= f.input :title %>
  <% @event.pictures.each do |picture| %>
    <%= f.inputs :for => [:pictures,picture], :class => :image do |ref| %>
      <%= f.input :main_picture_id, :as => :radio, :collection => [["Main Picture",picture.id]] %>
      <%= picture.id %>
      <%= @event.main_picture_id %>
      <%= ref.input :image, :as => :file %>
      <%= picture.filename %>
      <%= ref.input :caption %>
    <% end %>
  <% end %>
  <%= f.submit either_of(@event.new_record?,create(:event),update(:event)) %>
<% end %>
